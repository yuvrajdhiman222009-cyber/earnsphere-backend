<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payment - EarnSphere</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    margin:0;
    font-family:'Poppins', sans-serif;
    background: #f5f7fb;
    color:#333;
  }
  header {
    background: linear-gradient(90deg, #00f2fe, #4facfe);
    padding:20px;
    text-align:center;
    font-size:28px;
    font-weight:700;
    color:white;
  }
  .container {
    max-width:500px;
    margin:60px auto;
    background:#fff;
    padding:30px;
    border-radius:15px;
    box-shadow:0 6px 20px rgba(0,0,0,0.1);
    text-align:center;
  }
  h2 { margin-bottom:20px; color:#4facfe; }
  p { margin-bottom:25px; font-size:15px; color:#666; }
  button {
    width:100%;
    padding:14px;
    border:none;
    border-radius:25px;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
    margin-top:15px;
    transition:0.3s;
  }
  .pay-btn {
    background: linear-gradient(90deg, #00f2fe, #4facfe);
    color:white;
  }
  .pay-btn:hover { opacity:0.85; }
  .login-btn {
    background:#333;
    color:white;
  }
  .login-btn:hover { opacity:0.8; }
</style>
</head>
<body>

<header>Complete Your Payment</header>

<div class="container">
  <h2>Unlock Dashboard Access</h2>
  <p>Pay <strong>₹200</strong> once to access the EarnSphere Dashboard with 40+ affiliate opportunities.</p>

  <!-- Payment Button -->
  <button class="pay-btn" id="rzp-button">Pay ₹200 with Razorpay</button>

  <!-- Already Paid Option -->
  <p style="margin-top:25px;">Already paid?</p>
  <button class="login-btn" onclick="window.location.href='login.html'">Login</button>
</div>

<!-- Razorpay Script -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
document.getElementById("rzp-button").onclick = async function(e) {
  e.preventDefault();

  // Call backend to create order
  const orderRes = await fetch("/create-order", { method: "POST" });
  const order = await orderRes.json();

  var options = {
    "key": "rzp_test_RHwTufCqltFTWJ", // Replace with your Razorpay Key ID
    "amount": order.amount,
    "currency": "INR",
    "name": "EarnSphere",
    "description": "Access to Dashboard",
    "order_id": order.id,
    "handler": async function (response){
      // Notify backend of payment success
      await fetch("/payment-success", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ paymentId: response.razorpay_payment_id })
      });
      alert("✅ Payment successful! You can now login.");
      window.location.href = "signup.html"; // redirect to login page
    },
    "theme": { "color": "#4facfe" }
  };

  var rzp1 = new Razorpay(options);
  rzp1.open();
}
</script>

</body>
</html>
